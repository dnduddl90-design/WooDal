# ê¸°ëŠ¥ êµ¬í˜„ ê°€ì´ë“œ

> ì•„ì´ì½˜, ê³ ì •ì§€ì¶œ, ì˜ˆì‚°, í†µê³„ ê¸°ëŠ¥ êµ¬í˜„ ê°€ì´ë“œ

**ì‘ì„±ì¼**: 2025-10-15
**ë‚œì´ë„**: â­â­â­ (ì¤‘ê¸‰)
**ì†Œìš” ì‹œê°„**: ì•½ 3-4ì‹œê°„

---

## ğŸ“‹ ëª©ì°¨

1. [ì•„ì´ì½˜ ì»¤ìŠ¤í„°ë§ˆì´ì§•](#1-ì•„ì´ì½˜-ì»¤ìŠ¤í„°ë§ˆì´ì§•)
2. [ê³ ì •ì§€ì¶œ ìë™ ë“±ë¡](#2-ê³ ì •ì§€ì¶œ-ìë™-ë“±ë¡)
3. [ì˜ˆì‚° ê´€ë¦¬ ì‹œê°í™”](#3-ì˜ˆì‚°-ê´€ë¦¬-ì‹œê°í™”)
4. [í†µê³„ íŠ¸ë Œë“œ ë¶„ì„](#4-í†µê³„-íŠ¸ë Œë“œ-ë¶„ì„)

---

## 1. ì•„ì´ì½˜ ì»¤ìŠ¤í„°ë§ˆì´ì§•

### 3ê°€ì§€ êµ¬í˜„ ë°©ë²• ë¹„êµ

| ë°©ë²• | ë‚œì´ë„ | ìš©ëŸ‰ | ì»¤ìŠ¤í„°ë§ˆì´ì§• | ì¶”ì²œ |
|------|--------|------|--------------|------|
| **Emoji Picker** | ì‰¬ì›€ | 0KB | ì œí•œì  | â­â­â­ |
| **ì´ë¯¸ì§€ ì—…ë¡œë“œ** | ë³´í†µ | í¼ | ììœ ë¡œì›€ | â­â­ |
| **Avatar Generator** | ì–´ë ¤ì›€ | ì¤‘ê°„ | ì œí•œì  | â­ |

### Emoji Picker êµ¬í˜„ (ê¶Œì¥)

#### íŒŒì¼: `src/components/forms/AvatarPicker.js`

```javascript
import React, { useState } from 'react';

const EMOJI_LIST = ['ğŸ‘¨', 'ğŸ‘©', 'ğŸ‘¦', 'ğŸ‘§', 'ğŸ§‘', 'ğŸ‘´', 'ğŸ‘µ', 'ğŸ¶', 'ğŸ±', 'ğŸ¦Š', 'ğŸ¼', 'ğŸ¨'];

export const AvatarPicker = ({ currentAvatar, onSelect, onClose }) => {
  const [selected, setSelected] = useState(currentAvatar);

  const handleSave = () => {
    onSelect(selected);
    onClose();
  };

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div className="bg-white rounded-lg p-6 max-w-md w-full">
        <h2 className="text-xl font-bold mb-4">ì•„ë°”íƒ€ ì„ íƒ</h2>

        <div className="grid grid-cols-6 gap-3 mb-6">
          {EMOJI_LIST.map(emoji => (
            <button
              key={emoji}
              onClick={() => setSelected(emoji)}
              className={`text-4xl p-3 rounded-lg transition-all ${
                selected === emoji
                  ? 'bg-blue-100 ring-2 ring-blue-500'
                  : 'hover:bg-gray-100'
              }`}
            >
              {emoji}
            </button>
          ))}
        </div>

        <div className="flex gap-2">
          <button onClick={onClose} className="flex-1 btn-secondary">
            ì·¨ì†Œ
          </button>
          <button onClick={handleSave} className="flex-1 btn-primary">
            ì €ì¥
          </button>
        </div>
      </div>
    </div>
  );
};
```

### Firebase í†µí•©

```javascript
// useAuth.js
const updateAvatar = async (newAvatar) => {
  if (!currentUser?.firebaseId) return;

  try {
    await updateUserAvatar(currentUser.firebaseId, newAvatar);
    setCurrentUser(prev => ({ ...prev, avatar: newAvatar }));
  } catch (error) {
    console.error('ì•„ë°”íƒ€ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
  }
};
```

---

## 2. ê³ ì •ì§€ì¶œ ìë™ ë“±ë¡

### ì‹œìŠ¤í…œ ì„¤ê³„

**ë°ì´í„° ëª¨ë¸**:
```javascript
{
  id: 1728901234567,
  name: "ë„·í”Œë¦­ìŠ¤ êµ¬ë…ë£Œ",
  category: "subscription",
  amount: 13900,
  autoRegisterDate: 5,      // ë§¤ì›” 5ì¼
  isActive: true
}
```

**ìë™ ìƒì„± ê±°ë˜**:
```javascript
{
  id: 1729012345678,
  date: "2025-10-05",
  memo: "[ìë™ë“±ë¡] ë„·í”Œë¦­ìŠ¤ êµ¬ë…ë£Œ",
  fixedExpenseId: 1728901234567,  // ì¤‘ë³µ ë°©ì§€
  isAutoRegistered: true
}
```

### êµ¬í˜„: autoRegisterService.js

```javascript
const LAST_CHECK_KEY = 'lastAutoRegisterCheck';

export const autoRegisterFixedExpenses = async (
  fixedExpenses,
  transactions,
  userId,
  onRegister
) => {
  const today = new Date();
  const todayStr = formatDate(today);
  const lastCheck = localStorage.getItem(LAST_CHECK_KEY);

  // ì˜¤ëŠ˜ ì´ë¯¸ ì²´í¬í–ˆìœ¼ë©´ ìŠ¤í‚µ (ì„±ëŠ¥ ìµœì í™”)
  if (lastCheck === todayStr) {
    return 0;
  }

  let count = 0;

  for (const fixed of fixedExpenses) {
    // 1. ì˜¤ëŠ˜ì´ ë“±ë¡ì¼ì¸ê°€?
    if (fixed.autoRegisterDate !== today.getDate() || !fixed.isActive) {
      continue;
    }

    // 2. ì´ë¯¸ ì˜¤ëŠ˜ ë“±ë¡ë˜ì—ˆëŠ”ê°€?
    const exists = transactions.some(t =>
      t.date === todayStr && t.fixedExpenseId === fixed.id
    );

    if (exists) continue;

    // 3. ê±°ë˜ ìƒì„± ë° ë“±ë¡
    const transaction = {
      id: Date.now() + Math.random(),
      type: 'expense',
      category: fixed.category,
      amount: fixed.amount,
      date: todayStr,
      userId,
      memo: `[ìë™ë“±ë¡] ${fixed.name}`,
      fixedExpenseId: fixed.id,
      isAutoRegistered: true
    };

    await onRegister(transaction);
    count++;
  }

  // ë§ˆì§€ë§‰ ì²´í¬ ë‚ ì§œ ì €ì¥
  localStorage.setItem(LAST_CHECK_KEY, todayStr);

  return count;
};
```

### App.js í†µí•©

```javascript
useEffect(() => {
  if (isAuthenticated && currentUser && fixedExpenses.length > 0) {
    autoRegisterFixedExpenses(
      fixedExpenses,
      transactions,
      currentUser.id,
      registerFixedExpense
    ).then(count => {
      if (count > 0) {
        alert(`ğŸ‰ ${count}ê±´ì˜ ê³ ì •ì§€ì¶œì´ ìë™ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!`);
      }
    });
  }
}, [isAuthenticated, currentUser?.id, fixedExpenses.length]);
```

---

## 3. ì˜ˆì‚° ê´€ë¦¬ ì‹œê°í™”

### ìƒ‰ìƒ ì½”ë”© ì‹œìŠ¤í…œ

```
0-80%:  ğŸŸ¢ ì •ìƒ (ì´ˆë¡ìƒ‰)
80-100%: ğŸŸ  ê²½ê³  (ì£¼í™©ìƒ‰)
100%+:  ğŸ”´ ìœ„í—˜ (ë¹¨ê°„ìƒ‰)
```

### ì§„í–‰ë¥  ë°” êµ¬í˜„

```javascript
const percentage = (currentExpense / budget) * 100;

<div className="w-full bg-gray-200 rounded-full h-8">
  <div
    className={`h-8 rounded-full transition-all duration-1000 ${
      percentage > 100
        ? 'bg-gradient-to-r from-red-400 to-red-600'
        : percentage > 80
        ? 'bg-gradient-to-r from-orange-400 to-orange-600'
        : 'bg-gradient-to-r from-green-400 to-green-600'
    }`}
    style={{ width: `${Math.min(percentage, 100)}%` }}
  >
    <div className="text-white font-bold text-sm text-center">
      {formatCurrency(currentExpense)}ì›
    </div>
  </div>
</div>
```

### ì¹´í…Œê³ ë¦¬ë³„ ì˜ˆì‚°

```javascript
{CATEGORIES.expense.map(category => {
  const budgetAmount = parseInt(settings.budget.categories[category.id]) || 0;
  if (budgetAmount === 0) return null;

  const spentAmount = currentMonthData
    .filter(t => t.type === 'expense' && t.category === category.id)
    .reduce((sum, t) => sum + t.amount, 0);

  const percentage = (spentAmount / budgetAmount) * 100;
  const isOver = spentAmount > budgetAmount;

  return (
    <div key={category.id} className="space-y-2">
      <div className="flex justify-between">
        <span>{category.name}</span>
        <span className={isOver ? 'text-red-600' : 'text-gray-600'}>
          {formatCurrency(spentAmount)} / {formatCurrency(budgetAmount)}ì›
        </span>
      </div>

      <div className="w-full bg-gray-200 rounded-full h-2.5">
        <div
          className={`h-2.5 rounded-full transition-all ${
            isOver ? 'bg-red-500' : 'bg-green-500'
          }`}
          style={{ width: `${Math.min(percentage, 100)}%` }}
        />
      </div>

      {isOver && (
        <p className="text-xs text-red-600">
          âš ï¸ {formatCurrency(spentAmount - budgetAmount)}ì› ì´ˆê³¼
        </p>
      )}
    </div>
  );
}).filter(Boolean)}
```

---

## 4. í†µê³„ íŠ¸ë Œë“œ ë¶„ì„

### ìµœê·¼ 6ê°œì›” ë°ì´í„° ìˆ˜ì§‘

```javascript
const last6Months = [];

for (let i = 5; i >= 0; i--) {
  const targetDate = new Date(year, month - i, 1);
  const targetYear = targetDate.getFullYear();
  const targetMonth = targetDate.getMonth();

  // ì›”ì˜ ì‹œì‘/ë ë‚ ì§œ
  const monthStart = new Date(targetYear, targetMonth, 1);
  const monthEnd = new Date(targetYear, targetMonth + 1, 0);

  // í•´ë‹¹ ì›”ì˜ ê±°ë˜ í•„í„°ë§
  const monthData = transactions.filter(t => {
    const date = new Date(t.date);
    return date >= monthStart && date <= monthEnd;
  });

  // ìˆ˜ì…/ì§€ì¶œ ì§‘ê³„
  const income = monthData
    .filter(t => t.type === 'income')
    .reduce((sum, t) => sum + t.amount, 0);

  const expense = monthData
    .filter(t => t.type === 'expense')
    .reduce((sum, t) => sum + t.amount, 0);

  last6Months.push({
    month: `${targetMonth + 1}ì›”`,
    income,
    expense,
    saving: income - expense
  });
}
```

### ìƒëŒ€ì  ë¹„ìœ¨ ì‹œê°í™”

```javascript
// 6ê°œì›” ì¤‘ ìµœëŒ“ê°’ ì°¾ê¸°
const maxAmount = Math.max(
  ...last6Months.map(m => Math.max(m.income, m.expense))
);

{last6Months.map((data, index) => {
  const incomePercentage = (data.income / maxAmount) * 100;
  const expensePercentage = (data.expense / maxAmount) * 100;
  const isCurrentMonth = index === last6Months.length - 1;

  return (
    <div key={index} className={isCurrentMonth ? 'bg-blue-50 p-3 rounded' : ''}>
      <span className="text-sm font-medium">
        {data.month} {isCurrentMonth && '(ì´ë²ˆ ë‹¬)'}
      </span>

      {/* ì´ì¤‘ ì§„í–‰ë¥  ë°” */}
      <div className="flex gap-1 mt-2">
        <div
          className="h-2.5 bg-green-500 rounded"
          style={{ width: `${incomePercentage}%` }}
        />
        <div
          className="h-2.5 bg-red-500 rounded"
          style={{ width: `${expensePercentage}%` }}
        />
      </div>

      <div className="text-xs mt-1 text-gray-600">
        ìˆ˜ì…: {formatCurrency(data.income)}ì› /
        ì§€ì¶œ: {formatCurrency(data.expense)}ì›
      </div>
    </div>
  );
})}
```

### ê°€ì¡± êµ¬ì„±ì›ë³„ ì§€ì¶œ ë¶„ì„

```javascript
const expensesByUser = currentMonthData
  .filter(t => t.type === 'expense')
  .reduce((acc, t) => {
    const userId = t.userId || 'unknown';
    acc[userId] = (acc[userId] || 0) + t.amount;
    return acc;
  }, {});

{Object.entries(expensesByUser).map(([userId, amount]) => {
  const userName = userId === 'user1' ? 'ìš°ì˜ ğŸ‘¨' : 'ë‹¬ë¦¼ ğŸ‘©';
  const percentage = ((amount / currentExpense) * 100).toFixed(1);

  return (
    <div key={userId} className="flex justify-between">
      <span>{userName}</span>
      <span>
        {formatCurrency(amount)}ì› ({percentage}%)
      </span>
    </div>
  );
})}
```

---

## ê³µí†µ í•™ìŠµ í¬ì¸íŠ¸

### 1. ë‚ ì§œ ê³„ì‚°

```javascript
// ì›”ì˜ ë§ˆì§€ë§‰ ë‚ 
new Date(year, month + 1, 0);  // ë‹¤ìŒ ë‹¬ 0ì¼ = ì´ë²ˆ ë‹¬ ë§ˆì§€ë§‰ ë‚ 

// Nê°œì›” ì „ ê³„ì‚°
new Date(year, month - N, 1);  // JavaScriptê°€ ìë™ìœ¼ë¡œ ìŒìˆ˜ ì²˜ë¦¬
```

### 2. ë°°ì—´ ì§‘ê³„ íŒ¨í„´

```javascript
// í•©ê³„
array.filter(ì¡°ê±´).reduce((sum, item) => sum + item.amount, 0);

// ê·¸ë£¹í•‘
array.reduce((acc, item) => {
  acc[item.key] = (acc[item.key] || 0) + item.value;
  return acc;
}, {});

// ìµœëŒ“ê°’
Math.max(...array.map(item => item.value));
```

### 3. ë™ì  ìŠ¤íƒ€ì¼ë§

```javascript
// âŒ TailwindëŠ” ë™ì  í´ë˜ìŠ¤ ìƒì„± ì•ˆ ë¨
<div className={`w-${percentage}%`}>

// âœ… ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ ì‚¬ìš©
<div style={{ width: `${percentage}%` }}>
```

### 4. ì¡°ê±´ë¶€ ë Œë”ë§

```javascript
// ë‹¨ìˆœ ì¡°ê±´
{condition && <Component />}

// ì‚¼í•­ ì—°ì‚°ì
{condition ? <A /> : <B />}

// ì¡°ê¸° ë°˜í™˜ (map ë‚´ë¶€)
if (!condition) return null;
```

---

## ë§ˆë¬´ë¦¬

### êµ¬í˜„ ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

**ì•„ì´ì½˜**:
- [x] Emoji Picker ì»´í¬ë„ŒíŠ¸
- [x] Firebase ì•„ë°”íƒ€ ì €ì¥/ë¡œë“œ
- [x] ì‚¬ìš©ì í”„ë¡œí•„ì— í‘œì‹œ

**ê³ ì •ì§€ì¶œ**:
- [x] ìë™ ë“±ë¡ ë¡œì§
- [x] ì¤‘ë³µ ë°©ì§€ (fixedExpenseId)
- [x] LocalStorage ìµœì í™”

**ì˜ˆì‚°**:
- [x] ì§„í–‰ë¥  ë°” ì‹œê°í™”
- [x] ìƒ‰ìƒ ì½”ë”© (ì´ˆë¡/ì£¼í™©/ë¹¨ê°•)
- [x] ì¹´í…Œê³ ë¦¬ë³„ ì˜ˆì‚°

**í†µê³„**:
- [x] ìµœê·¼ 6ê°œì›” íŠ¸ë Œë“œ
- [x] ìƒëŒ€ì  ë¹„ìœ¨ ê·¸ë˜í”„
- [x] ê°€ì¡± êµ¬ì„±ì›ë³„ ë¶„ì„

### í•µì‹¬ ê°œë… ìš”ì•½

1. **ì»´í¬ë„ŒíŠ¸ ì¬ì‚¬ìš©**: ê³µí†µ ë¡œì§ì„ í›…/ì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬
2. **ë°ì´í„° ì§‘ê³„**: filter + reduce íŒ¨í„´ ë§ˆìŠ¤í„°
3. **ë‚ ì§œ ê³„ì‚°**: JavaScript Date ê°ì²´ í™œìš©
4. **ì‹œê°í™”**: ì§„í–‰ë¥  ë°” + ìƒ‰ìƒ ì½”ë”©
5. **ì„±ëŠ¥ ìµœì í™”**: LocalStorage ìºì‹±

---

**ì‘ì„±ì**: Claude Code
**ë²„ì „**: 2.0 (í†µí•©)
**ë¼ì´ì„ ìŠ¤**: MIT

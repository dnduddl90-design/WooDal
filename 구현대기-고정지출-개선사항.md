# êµ¬í˜„ ëŒ€ê¸° ì¤‘ - ê³ ì •ì§€ì¶œ ê°œì„  ì‚¬í•­

## 1. ë¬´ê¸°í•œ ê³ ì •ì§€ì¶œì— startDate ì €ì¥ (ì½”ë“œ ìˆ˜ì •)

### í˜„ì¬ ë¬¸ì œ
```javascript
ë¬´ê¸°í•œ í•­ëª©:
  isUnlimited: true
  startDate: ''  // ë¹ˆ ë¬¸ìì—´
  endDate: ''
```
- ì–¸ì œë¶€í„° êµ¬ë…í–ˆëŠ”ì§€ ì•Œ ìˆ˜ ì—†ìŒ
- í†µê³„ ê³„ì‚° ì‹œ ì‹œì‘ì  ë¶ˆëª…í™•

### ë³€ê²½ ì˜ˆì •
```javascript
ë¬´ê¸°í•œ í•­ëª©:
  isUnlimited: true
  startDate: '2025-12-09'  // ë“±ë¡í•œ ë‚ ì§œ ìë™ ì €ì¥
  endDate: ''              // ì¢…ë£Œì¼ ì—†ìŒ
```

### ìˆ˜ì • í•„ìš” íŒŒì¼

#### A. `src/components/forms/FixedExpenseForm.js`
**ìœ„ì¹˜:** 104-122ë²ˆì§¸ ì¤„ (ë¬´ê¸°í•œ toggle ë²„íŠ¼)

**í˜„ì¬ ì½”ë“œ:**
```javascript
onClick={() => onFormChange({
  ...formData,
  isUnlimited: !formData.isUnlimited,
  startDate: formData.isUnlimited ? new Date().toISOString().split('T')[0] : '',
  endDate: ''
})}
```

**ìˆ˜ì • ë°©ì•ˆ:**
```javascript
onClick={() => {
  const newIsUnlimited = !formData.isUnlimited;
  onFormChange({
    ...formData,
    isUnlimited: newIsUnlimited,
    startDate: newIsUnlimited
      ? (formData.startDate || new Date().toISOString().split('T')[0])  // ë¬´ê¸°í•œì´ë©´ í˜„ì¬ ë‚ ì§œ ìœ ì§€ ë˜ëŠ” ì˜¤ëŠ˜
      : (formData.startDate || new Date().toISOString().split('T')[0]), // ê¸°ê°„ ì œí•œì´ë©´ ì˜¤ëŠ˜ë¡œ ì´ˆê¸°í™”
    endDate: newIsUnlimited ? '' : formData.endDate
  });
}}
```

#### B. `src/hooks/useFixedExpenses.js` (ë˜ëŠ” ê´€ë ¨ hook)
**ìˆ˜ì • ìœ„ì¹˜:** `handleAddFixedExpense` ë˜ëŠ” `handleUpdateFixedExpense` í•¨ìˆ˜

**ì¶”ê°€ ë¡œì§:**
```javascript
// ì €ì¥ ì „ startDate ë³´ì¥
if (!fixedExpense.startDate) {
  fixedExpense.startDate = formatDate(new Date());
}
```

### ê¸°ëŒ€ íš¨ê³¼
- âœ… ëª¨ë“  ê³ ì •ì§€ì¶œì´ startDateë¥¼ ê°€ì§
- âœ… "ë„·í”Œë¦­ìŠ¤ 3ê°œì›”ì§¸ êµ¬ë… ì¤‘" ê°™ì€ ë¶„ì„ ê°€ëŠ¥
- âœ… í•´ì§€ ì‹œ ì‚¬ìš© ê¸°ê°„ í‘œì‹œ ê°€ëŠ¥
- âœ… í†µê³„ ê³„ì‚° ì‹œ ì¼ê´€ì„± í™•ë³´

---

## 2. ê¸°ì¡´ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜

### ëª©ì 
- ì´ë¯¸ ì €ì¥ëœ ë¬´ê¸°í•œ ê³ ì •ì§€ì¶œì˜ startDateë¥¼ '2025-10-01'ë¡œ ì—…ë°ì´íŠ¸

### ëŒ€ìƒ
```javascript
ì¡°ê±´:
  isUnlimited === true
  && (startDate === '' || !startDate)
```

### êµ¬í˜„ ë°©ì‹: ì„ì‹œ ê´€ë¦¬ì ë²„íŠ¼

#### A. `src/pages/FixedExpensePage.js`ì— ì„ì‹œ ë²„íŠ¼ ì¶”ê°€
**ìœ„ì¹˜:** í—¤ë” ì„¹ì…˜ (24-37ë²ˆì§¸ ì¤„)

**ì¶”ê°€ ì½”ë“œ:**
```javascript
import { useState } from 'react';

// ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€
const [isMigrating, setIsMigrating] = useState(false);

const handleMigrateData = async () => {
  if (!window.confirm('ê¸°ì¡´ ë¬´ê¸°í•œ ê³ ì •ì§€ì¶œì˜ ì‹œì‘ì¼ì„ 2025-10-01ë¡œ ì„¤ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
    return;
  }

  setIsMigrating(true);
  try {
    // 1. ëª¨ë“  ê³ ì •ì§€ì¶œ ê°€ì ¸ì˜¤ê¸°
    const fixedExpensesToUpdate = fixedExpenses.filter(
      fixed => fixed.isUnlimited && (!fixed.startDate || fixed.startDate === '')
    );

    console.log(`ë§ˆì´ê·¸ë ˆì´ì…˜ ëŒ€ìƒ: ${fixedExpensesToUpdate.length}ê°œ`);

    // 2. ê° í•­ëª© ì—…ë°ì´íŠ¸
    for (const fixed of fixedExpensesToUpdate) {
      await onEdit(fixed.id, {
        ...fixed,
        startDate: '2025-10-01'
      });
    }

    alert(`âœ… ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ! ${fixedExpensesToUpdate.length}ê°œ í•­ëª©ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.`);
  } catch (error) {
    console.error('ë§ˆì´ê·¸ë ˆì´ì…˜ ì˜¤ë¥˜:', error);
    alert('âŒ ë§ˆì´ê·¸ë ˆì´ì…˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
  } finally {
    setIsMigrating(false);
  }
};

// JSX ë²„íŠ¼ (í—¤ë”ì— ì¶”ê°€)
<Button
  variant="secondary"
  onClick={handleMigrateData}
  disabled={isMigrating}
  className="text-xs"
>
  {isMigrating ? 'ì²˜ë¦¬ ì¤‘...' : 'ğŸ”§ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜'}
</Button>
```

#### B. ì‹¤í–‰ í›„ ë²„íŠ¼ ì‚­ì œ
- ë§ˆì´ê·¸ë ˆì´ì…˜ ì„±ê³µ í™•ì¸
- Firebaseì—ì„œ ë°ì´í„° í™•ì¸
- ë²„íŠ¼ ì½”ë“œ ì£¼ì„ ì²˜ë¦¬ ë˜ëŠ” ì‚­ì œ

### ì£¼ì˜ì‚¬í•­
- âš ï¸ ì‹¤í–‰ ì „ Firebase ë°±ì—… ê¶Œì¥
- âš ï¸ í•œ ë²ˆë§Œ ì‹¤í–‰ (ì—¬ëŸ¬ ë²ˆ ì‹¤í–‰í•´ë„ ì•ˆì „í•˜ì§€ë§Œ ë¶ˆí•„ìš”)
- âš ï¸ ê°œë°œ í™˜ê²½ì—ì„œ ë¨¼ì € í…ŒìŠ¤íŠ¸

---

## 3. ê³ ì •ì§€ì¶œ í•´ì§€ ê¸°ëŠ¥

### ê°œë…
- **ì‚­ì œ** â†’ **í•´ì§€**ë¡œ ë³€ê²½
- ë°ì´í„°ëŠ” ìœ ì§€, ëª©ë¡ì—ì„œë§Œ ìˆ¨ê¹€
- ì˜¤ëŠ˜ ì´í›„ ìë™ë“±ë¡ ì¤‘ë‹¨

### í•´ì§€ ë™ì‘
```javascript
í•´ì§€ ë²„íŠ¼ í´ë¦­ ì‹œ:
  startDate: ê¸°ì¡´ ê°’ ìœ ì§€  // âœ… ì‹¤ì œ êµ¬ë… ì‹œì‘ì¼ ë³´ì¡´
  endDate: ì˜¤ëŠ˜ ë‚ ì§œ      // ì˜¤ëŠ˜ë¡œ ì¢…ë£Œ
  isUnlimited: false      // ê¸°ê°„ ì œí•œìœ¼ë¡œ ë³€ê²½
```

**ì˜ˆì‹œ:**
```javascript
// 2025-11-15ì— ì¶”ê°€í•œ ë„·í”Œë¦­ìŠ¤ë¥¼ 2025-12-09ì— í•´ì§€
ê¸°ì¡´: { startDate: '2025-11-15', endDate: '', isUnlimited: true }
í•´ì§€ í›„: { startDate: '2025-11-15', endDate: '2025-12-09', isUnlimited: false }
â†’ ê²°ê³¼: 25ì¼ê°„ ì‚¬ìš©í–ˆë‹¤ëŠ” ì •í™•í•œ ê¸°ë¡ ë³´ì¡´
```

**ì™œ startDateë¥¼ ìœ ì§€í•˜ë‚˜?**
- 1ë²ˆ + 2ë²ˆ ì™„ë£Œ í›„ ëª¨ë“  ê³ ì •ì§€ì¶œì€ ì´ë¯¸ startDateë¥¼ ê°€ì§€ê³  ìˆìŒ
- ì‹¤ì œ êµ¬ë… ì‹œì‘ì¼ì„ ë³´ì¡´í•˜ëŠ” ê²ƒì´ ì •í™•í•œ ë°ì´í„°
- ì‚¬ìš© ê¸°ê°„ ë¶„ì„ ì‹œ ì •í™•ë„ í–¥ìƒ

### ê²°ê³¼
- âœ… ì´ë¯¸ êµ¬í˜„ëœ í•„í„°ë§ìœ¼ë¡œ ëª©ë¡ì—ì„œ ìë™ ìˆ¨ê¹€
- âœ… ì˜¤ëŠ˜ê¹Œì§€ë§Œ ìœ íš¨ ê¸°ê°„
- âœ… ë‚´ì¼ë¶€í„° ìë™ë“±ë¡ ì¤‘ë‹¨
- âœ… ê³¼ê±° ë°ì´í„° ë° í†µê³„ ë³´ì¡´
- âœ… ì‹¤ì œ êµ¬ë… ì‹œì‘ì¼ ì •ë³´ ë³´ì¡´

### ìˆ˜ì • í•„ìš” íŒŒì¼

#### A. `src/pages/FixedExpensePage.js`
**ìœ„ì¹˜:** 184-202ë²ˆì§¸ ì¤„ (ì‚­ì œ ë²„íŠ¼)

**í˜„ì¬:**
```javascript
<Button
  variant="danger"
  size="sm"
  icon={Trash2}
  onClick={() => onDelete(fixed.id)}
>
  ì‚­ì œ
</Button>
```

**ë³€ê²½:**
```javascript
import { StopCircle } from 'lucide-react';

<Button
  variant="danger"
  size="sm"
  icon={StopCircle}
  onClick={() => onCancel(fixed.id)}
>
  í•´ì§€
</Button>
```

#### B. `src/hooks/useFixedExpenses.js` (ë˜ëŠ” App.js)
**ì¶”ê°€ í•¨ìˆ˜:**
```javascript
const handleCancelFixedExpense = async (id) => {
  const fixedExpense = fixedExpenses.find(f => f.id === id);
  if (!fixedExpense) return;

  const startDateStr = fixedExpense.startDate || 'ì•Œ ìˆ˜ ì—†ìŒ';
  const today = formatDate(new Date());

  if (!window.confirm(
    `ì´ ê³ ì •ì§€ì¶œì„ í•´ì§€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n` +
    `ğŸ“… êµ¬ë… ê¸°ê°„: ${startDateStr} ~ ${today}\n\n` +
    `- ì˜¤ëŠ˜ ì´í›„ë¡œëŠ” ìë™ ë“±ë¡ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤\n` +
    `- ì´ì „ ê¸°ë¡ì€ ìœ ì§€ë©ë‹ˆë‹¤\n` +
    `- ëª©ë¡ì—ì„œ ìˆ¨ê²¨ì§‘ë‹ˆë‹¤`
  )) {
    return;
  }

  const updatedExpense = {
    ...fixedExpense,
    // startDateëŠ” ê±´ë“œë¦¬ì§€ ì•ŠìŒ (ì‹¤ì œ êµ¬ë… ì‹œì‘ì¼ ë³´ì¡´)
    endDate: today,           // ì˜¤ëŠ˜ë¡œ ì¢…ë£Œ
    isUnlimited: false        // ê¸°ê°„ ì œí•œìœ¼ë¡œ ë³€ê²½
  };

  try {
    await updateFixedExpense(familyId, id, updatedExpense);
    alert('âœ… ê³ ì •ì§€ì¶œì´ í•´ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.');
  } catch (error) {
    console.error('í•´ì§€ ì˜¤ë¥˜:', error);
    alert('âŒ í•´ì§€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
  }
};
```

**Props ì¶”ê°€:**
```javascript
<FixedExpensePage
  ...
  onCancel={handleCancelFixedExpense}  // ì¶”ê°€
/>
```

#### C. `src/services/autoRegisterService.js` (ìë™ë“±ë¡ ì„œë¹„ìŠ¤)
**ì¶”ê°€ ì²´í¬:**
```javascript
// ìë™ ë“±ë¡ ì „ endDate ì²´í¬
const shouldAutoRegister = (fixedExpense, targetDate) => {
  const targetDateStr = formatDate(targetDate);

  // endDateê°€ ìˆê³  ëª©í‘œ ë‚ ì§œê°€ endDate ì´í›„ë©´ ë“±ë¡ ì•ˆí•¨
  if (fixedExpense.endDate && targetDateStr > fixedExpense.endDate) {
    return false;
  }

  // startDateê°€ ìˆê³  ëª©í‘œ ë‚ ì§œê°€ startDate ì´ì „ì´ë©´ ë“±ë¡ ì•ˆí•¨
  if (fixedExpense.startDate && targetDateStr < fixedExpense.startDate) {
    return false;
  }

  return true;
};
```

### UI ë³€ê²½ ì‚¬í•­
- ì•„ì´ì½˜: `Trash2` â†’ `StopCircle`
- ë²„íŠ¼ í…ìŠ¤íŠ¸: "ì‚­ì œ" â†’ "í•´ì§€"
- í™•ì¸ ë©”ì‹œì§€: í•´ì§€ ì„¤ëª… í¬í•¨

### ì¶”ê°€ ê³ ë ¤ì‚¬í•­ (ì„ íƒ)
- í•´ì§€ëœ í•­ëª© ë³´ê¸° í† ê¸€ ë²„íŠ¼
- í•´ì§€ ì·¨ì†Œ ê¸°ëŠ¥ (endDate ì œê±°)
- ì™„ì „ ì‚­ì œ ê¸°ëŠ¥ (ê´€ë¦¬ì ì „ìš©)

---

## êµ¬í˜„ ìš°ì„ ìˆœìœ„

```
1ìˆœìœ„: ë¬´ê¸°í•œ í•­ëª© startDate ì €ì¥ (1ë²ˆ)
  - ëª¨ë“  ì‹ ê·œ ë°ì´í„°ì˜ ê¸°ë°˜
  - ì†Œìš” ì‹œê°„: 10ë¶„

2ìˆœìœ„: ê¸°ì¡´ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ (2ë²ˆ)
  - í•œ ë²ˆë§Œ ì‹¤í–‰í•˜ë©´ ë
  - 1ë²ˆ ì™„ë£Œ í›„ ì§„í–‰
  - ì†Œìš” ì‹œê°„: 15ë¶„

3ìˆœìœ„: ê³ ì •ì§€ì¶œ í•´ì§€ ê¸°ëŠ¥ (3ë²ˆ)
  - 1, 2ë²ˆ ì™„ë£Œ í›„ ëª¨ë“  ê³ ì •ì§€ì¶œì´ startDateë¥¼ ê°€ì§€ê³  ìˆìŒ
  - í•´ì§€ ì‹œ startDate ìœ ì§€, endDateë§Œ ì„¤ì •
  - ì†Œìš” ì‹œê°„: 20ë¶„
```

**ì´ ì˜ˆìƒ ì†Œìš” ì‹œê°„: 45ë¶„**

**ì¤‘ìš”:** 1ë²ˆê³¼ 2ë²ˆì´ ì™„ë£Œë˜ë©´ ëª¨ë“  ê³ ì •ì§€ì¶œì´ startDateë¥¼ ê°€ì§€ë¯€ë¡œ, 3ë²ˆì—ì„œëŠ” startDateë¥¼ ê±´ë“œë¦¬ì§€ ì•Šê³  endDateë§Œ ì„¤ì •í•˜ë©´ ë¨

---

## í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 1ë²ˆ í…ŒìŠ¤íŠ¸
- [ ] ë¬´ê¸°í•œ ê³ ì •ì§€ì¶œ ì‹ ê·œ ì¶”ê°€ â†’ startDate ìë™ ì €ì¥ í™•ì¸
- [ ] ê¸°ê°„ ì œí•œ â†’ ë¬´ê¸°í•œ ì „í™˜ â†’ startDate ìœ ì§€ í™•ì¸
- [ ] ë¬´ê¸°í•œ â†’ ê¸°ê°„ ì œí•œ ì „í™˜ â†’ startDate ìœ ì§€ í™•ì¸

### 2ë²ˆ í…ŒìŠ¤íŠ¸
- [ ] ë§ˆì´ê·¸ë ˆì´ì…˜ ë²„íŠ¼ í´ë¦­ â†’ ëŒ€ìƒ ê°œìˆ˜ í™•ì¸
- [ ] Firebaseì—ì„œ startDate ì—…ë°ì´íŠ¸ í™•ì¸
- [ ] í†µê³„ í˜ì´ì§€ì—ì„œ ì •ìƒ í‘œì‹œ í™•ì¸

### 3ë²ˆ í…ŒìŠ¤íŠ¸
- [ ] í•´ì§€ ë²„íŠ¼ í´ë¦­ â†’ endDateê°€ ì˜¤ëŠ˜ë¡œ ì„¤ì •
- [ ] startDateëŠ” ê¸°ì¡´ ê°’ ìœ ì§€ í™•ì¸ (ë³€ê²½ë˜ì§€ ì•ŠìŒ)
- [ ] í™•ì¸ ë©”ì‹œì§€ì— êµ¬ë… ê¸°ê°„ í‘œì‹œ í™•ì¸
- [ ] ëª©ë¡ì—ì„œ í•´ì§€ í•­ëª© ìë™ ìˆ¨ê¹€ í™•ì¸
- [ ] í†µê³„ì—ì„œ ì˜¤ëŠ˜ê¹Œì§€ë§Œ ë°˜ì˜ í™•ì¸
- [ ] ë‚´ì¼ ìë™ë“±ë¡ ì•ˆë˜ëŠ”ì§€ í™•ì¸

---

## ì°¸ê³  ì‚¬í•­

- ëª¨ë“  ë‚ ì§œëŠ” `formatDate()` í•¨ìˆ˜ ì‚¬ìš© ('YYYY-MM-DD' í˜•ì‹)
- Firebase ì—…ë°ì´íŠ¸ëŠ” ê¸°ì¡´ `updateFixedExpense()` í•¨ìˆ˜ í™œìš©
- í”„ë¡œì íŠ¸ ì‹œì‘ì¼: 2025-10-01
- í˜„ì¬ ë‚ ì§œ: 2025-12-09 (êµ¬í˜„ ì‹œì  ê¸°ì¤€)
